## Challenge: flag art

### Category: crypto

### Description: I encoded the flag in a painting. Enjoy!

### Author: joseph

Unfortunately, I wasn't able to solve this challenge in the CTF, but reviewing it, I think I should have been able to solve it. Nonetheless, the challenge I think was a pretty fun one. Looking at the source code for generating the ciphertext output file, the way the plaintext message was encrypted was by using certain characters in the ```palette``` string in groups of 4. In each group of 4, each character in the output file is determined by its index in the ```palette``` string, generated by the bytes representation of each character in the message *modulo* either 2, 3, 5, or 7 based in that order. You can read the source code here:

```python
message = open('./message.txt', 'rb').read() + open('./flag.txt', 'rb').read()

palette = '.=w-o^*'
template = list(open('./mask.txt', 'r').read())

canvas = ''
for c in message:
    for m in [2, 3, 5, 7]:
        while True:
            t = template.pop(0)
            if t == 'X':
                canvas += palette[c % m]
                break
            else:
                canvas += t

print(canvas)
```

The way I saw to solve the challenge was to consider each set of 4 characters in the ciphertext as being 4 components to finding the character in the message. I saw them as a set of 4 modular congruences, which can be used to find the chracter by encoding the number that fits all 4 equations into ASCII. I also took notice that all the moduli that generated the indices for the output characters are coprime. Therefore, I found that the Chinese Remainder Theorem is applicable, meaning that a unique number/solution can be found with the set of congruences. You can read about it [here](https://en.wikipedia.org/wiki/Chinese_remainder_theorem). Numerically, this can be done with methods such as a search by sieving or by using [this method](https://www.youtube.com/watch?v=MdePzlQtnCc&ab_channel=CalculusbyChristee). In Python, the sympy module has a function for applying the Chinese Remainder Theorem to find the right numbers, so I used that in my solve script. I then ran my solve script, and boom, flag received.

#### Flag: DUCTF{r3c0nstruct10n_0f_fl4g_fr0m_fl4g_4r7_by_l00kup_t4bl3_0r_ch1n3s3_r3m41nd3r1ng?}

Reviewed by giggsterpuku
