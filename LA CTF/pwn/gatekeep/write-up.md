# Challenge: gatekeep

**Category:** pwn

**Description:** If I gaslight you enough, you won't be able to get my flag! :)

## Breaking down the source code
`

int check(){
    char input[15];
    char pass[10];
    int access = 0;

    // If my password is random, I can gatekeep my flag! :)
    int data = open("/dev/urandom", O_RDONLY);
    if (data < 0)
    {
        printf("Can't access /dev/urandom.\n");
        exit(1);
    }
    else
    {
        ssize_t result = read(data, pass, sizeof pass);
        if (result < 0)
        {
            printf("Data not received from /dev/urandom\n");
            exit(1);
        }
    }
    close(data);

    printf("Password:\n");
    gets(input);

    if(strcmp(input, pass)) {
        printf("I swore that was the right password ...\n");
    }
    else {
        access = 1;
    }

    if(access) {
        printf("Guess I couldn't gaslight you!\n");
        print_flag();
    }
}

`

## What seems to be the intended play

## What I think is the :cheese:

The way that I actually solved the chall came from a chall that I remembered doing in the 2021 AngestromCTF competition to perform the exploit that I used for the Secure Login chall. My write-up in a text file can be found [here](https://github.com/giggsterpuku/CTF-Writeups/blob/main/angstromCTF/2021/Secure_Login/Secure_Login.txt). You can also find the files associated with the chall in the same directory. Essentially, the ğŸ§€ exploit comes from the generation of the password, which is made with the randomly generated bytes of /dev/urandom, along with strcmp() being used to compare the input and the password. strcmp() uses compares the two arguments until either argument terminates with a null byte. Since there is a chance that the first character taken from /dev/urandom starts with a null byte, I just have to keep sending a null byte to the remote service until the strcmp() check is passed.

> ğŸ“ **Note:** The ğŸ§€ exploit may take a while to get the flag.

**Flag:** lactf{sCr3am1nG_cRy1Ng_tHr0w1ng_uP}

Solved by giggsterpuku
