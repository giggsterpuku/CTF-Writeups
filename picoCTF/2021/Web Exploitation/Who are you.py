#!/usr/bin/env python3

################################# Write-Up ################################
# Challenge: Who are you?
# Category: Web Exploitation
# Description: Let me in. Let me iiiiiiinnnnnnnnnnnnnnnnnnnn http://mercury.picoctf.net:38322/
# Hints:
#	-1: It ain't much, but it's an RFC https://tools.ietf.org/html/rfc2616
# The idea of the chall is to use HTTP headers in the requests you make to
# specify certain fields that are checked by the site in order to get the
# flag. Entering one correct header led to a message prompting for more
# info, so I had to keep using the RFC resource and MDN Firefox HTTP header
# site to keep looking up the headers I needed.
#
# Flag: picoCTF{http_h34d3rs_v3ry_c0Ol_much_w0w_b22d773c}
# Solved by giggsterpuku in picoGym
# Points: 100
###########################################################################

import requests

url = 'http://mercury.picoctf.net:38322'

headers = {
	'User-Agent' : 'PicoBrowser', # User agent is what type of browser you are using to access the site
	'Referer' : url, # Indicates the orginal site you used to access the site you are looking at
	'Date' : "Mon, 02 Jan 2018 00:00:00 GMT",
	'DNT' : '1', # Do Not Track feature to remove tracking data from client
	'X-Forwarded-For' : '23.32.110.159', # Geolocation of IP provdided gives web server info abt where the client is logging in from, used this site to find an IP address in Sweden (which the comment asked for): https://tools.tracemyip.org/search--country/sweden
	'Accept-Language' : 'sv' # Uses 2-letter code to indicate preferred language, sv is for Swedish
}

response = requests.get(url, headers=headers)

print(response.text)
